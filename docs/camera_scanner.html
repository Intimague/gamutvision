<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Camera and scanner gamuts</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="Author" content="Norman Koren">
  <meta name="Description" content="Camera and scanner gamuts">
  <title>Gamutvision</title>
  <link href="style/style.css" rel="stylesheet" type="text/css">
</head>

<body>
<p><span class="module">Gamutvision</span> can display plots that apprear to represent the color gamut of input devices&mdash; scanners and cameras&mdash;  but <em><strong><font color="#990033">these plots must be interpreted with caution</font> </strong></em> because the RGB input pattern used by Gamutvision (and other gamut viewers) are likely to contain RGB values that can never be produced by most cameras or scanners in response to real, physical light. Hence the actual gamut is typically smaller than the displayed gamut. The reason is illustrated below in Kodak's published spectral response for the <a href="http://www.kodak.com/ezpres/business/ccd/global/plugins/acrobat/en/datasheet/fullframe/KAF-10500LongSpec.pdf" target="_blank">Kodak KAF-10500-CX</a> image sensor used in the <a href="http://www.luminous-landscape.com/reviews/cameras/m8-infrared.shtml" target="_blank">Leica M8</a>.</p>
<p align="center"><img src="images/Kodak_KAF-10500-CX_response.gif" alt="Kodak KAF-10500 spectrum" width="535" height="312" /> </p>
<p>There is considerable overlap between colors. That means that a sensor output that has not been processed  (except possibly for linear scaling) can <em><strong>never</strong></em> include pure R (255,0,0), G (0,255,0), or B (0,0,255) signals. Of course some signal processing is likely to take place because the KAF-10500 sensor output is an <em><strong>analog</strong></em> voltage: conversion to a digital signal takes place outside the sensor chip, and is likely to include manufacturer-proprietary processing&mdash; even in RAW files. </p>
<p>Another observation from this figure is that the R:G:B voltage ratio  is unique for any monochromatic (single-wavelength) signal inside the visual spectrum (about 380-720 namometers), hence the sensor can, in principle, distinguish any visible wavelength: it's gamut encompasses the full gamut of human vision. The actual gamut of a camera depends on the quality of the profile: on how well it handles strongly saturated colors. This can't be determined from a profile alone because it doesn't contain information on the relationship between all possible colorimetric values of illumination and a camera's RAW R,G,B values. Profiles are built from charts with limited numbers of color patches that cannot approach pure monochromatic values. They contain no information on which R,G,B values don't correspond to physical light. </p>
<p>Camera profiles are often installed along with raw conversion software. Likewise, scanner profiles are installed along with scanner control software. We use two manufacturer-supplied profiles as examples. Of course these aren't the last word in profile quality. Many users use profiling software to make their own profiles, with mostly pleasing results.</p>
<h2><a name="film" id="film"></a>Film gamut, apples, and oranges</h2>
<p>Some of your may have come across images of film gamut&mdash; usually displayed as CIE xy plots&mdash; (they're not very common). Film gamut diaplayed in these diagrams is quite large: larger than Adobe RGB (1998), though not equal to ultra-large gamut color spaces such as WGRGB or ProPhoto RGB.</p>
<p> It is important to realize that <em><strong>film gamut does not represent the range of film response to color&nbsp;</strong></em>: it is the range of colors that the film dyes can <em><strong>reproduce</strong></em>, ie. it is the film's <em><strong>output</strong></em> gamut. It has nothing to do with the film's response. For this reason, comparing film gamut to the gamut of digital cameras (or at least the &quot;gamut&quot; displayed by gamut viewer programs) is meaningless: it's about as classic an apples vs. oranges comparison as you can get. </p>
<h2><a name="camera" id="camera"></a>Camera profile:   EOS 20D.icc</h2>
<p>EOS 20D.icc was apparently installed along with Canon's DPP (Digital Photo Professional) RAW conversion software, though I found no obvious means of selecting the camera profile in DPP. It certainly came from Canon&mdash; it bears their copyright. And there's no doubt which camera it's intended for. The first image is a 3D L*a*b* plot that shows  the full gamut of the EOS 20D (solid; input profile 1) as well as the full gamut of the Adobe RGB (1998) color space (wireframe; output profile 2). All images on this page are somewhat reduced. </p>
<p align="center"><img src="images/EOS_20D_Adobe_RGB.jpg" alt="EOS 20D and Adobe RGB (1998) full gamuts" width="602" height="493" /></p>
<p>The display has been rotated to emphasize the differences between the profiles. Note that there is no gamut mapping in this diagram: the rendering intent has been set to <font size="-1" face="Arial, Helvetica, sans-serif">None</font>. Also, the normal 3D display order has been reversed: <strong class="button"><font size="-1">3D L*a*b* Refersed (wire output)</font></strong> (i.e., solid input) has been selected. The normal 3D display (wireframe input, solid output) makes sense when the output gamut is smaller than the input gamut, as it is for most printer output profiles. But in this case, the EOS 20D gamut is slightly smaller than Adobe RGB (1998).</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td><p>Of course a gamut mapping takes place when an image is transformed from  camera to working color space. The 3D L*a*b* image of the mapped transformation is shown on the right: it's trivial. Since Adobe RGB (1998) has a slightly larger gamut than the EOS-20D, the final gamut is the same as the 20D. For this mapping, perceptual, colorimetric, and saturation rendering intents produce the same results. Absolute rendering intent does not work with this profile. </p>
      <p>These results suggest that Adobe RGB (1998) is the ideal working color space for use with the EOS-20D, since the camera's effective gamut can be no larger than the selected profile (EOS 20D.icc in this case). Larger gamut spaces would be wasted; some colors would be clipped with sRGB (a small gamut color space). </p>
      <p>EOS 20D.icc is a large profile: 213 kB. It contains three <a href="http://www.normankoren.com/color_management_2.html#Prof_anatomy" target="_blank">AToB<em>n</em></a> lookup tables (device to profile connection space; <em>n</em> = 0 for perceptual; 1 for colorimetric; 2 for saturation). Judging from the profile's behavior, the AToB<em>n</em> tables are all the same. </p></td>
    <td><div align="right"><img src="images/EOS_20D_Adobe_RGB_mapped.jpg" alt="EOS-20D to Adobe RGB (1998) mapped" width="280" height="302" hspace="10" vspace="4" /></div></td>
  </tr>
</table>
<p>3D L*a*b* plots are only one of several types of <a href="gamutvision_displays.html">Gamutvision display</a>.  The 2D a*b* saturation plot is also valuable for displaying color gamuts. The input to this plot is a chart consisting of all hues and saturations in <a href="gamutvision_equations.html#Colorspace">HSL color representation</a>, where L(HSL) = 0.5, which is the middle lightness value where color saturation reaches its maximum. Pure red (255,0,0), green (0,255,0), and blue (0,0,255) all have L = 0.5. (L in HSL color representation is not the same as L* in L*a*b* space.)  The 2D s*b* saturation plot displays a*b* values for saturation S = {0, 0.2, 0.4, 0.6, 0.8, 1}.</p>
<p>The image below shows the results of two mappings: 1&rarr;2: EOS 20D.icc&rarr;AdobeRGB1998.icc, and 3&rarr;4: EOS 20D.icc&rarr;*sRGB. There are a number of ways the results can be displayed; the plot below takes advantage of Gamutvision's<font size="-1" face="Arial, Helvetica, sans-serif"> <strong>Display A/Display B</strong></font> feature, which allows any two results to be compared on the same plot&mdash; and to be quickly swiched. </p>
<p align="center"><img src="images/EOS_20D_Adobe_sRGB.jpg" alt="EOS-20D: gamut-mapped output for sRGB and Adobe RGB" width="602" height="493" hspace="6" vspace="6" /></p>
<p align="left">The dashed lines are the Adobe RGB (1998) output, mapped with colorimetric rendering intent from EOS 20D.icc; the result of the 1&rarr;2 mapping (which gives the same results as perceptual and saturation intent for this profile). The solid lines are the sRGB output; the result of the 3&rarr;4 mapping. It is clear that Adobe RGB has a much larger gamut in the green to cyan range. The 2D a*b* saturation plot is excellent for comparing gamuts, but keep in mind that it only displays middle tones, where colors are most intense. It doesn't display gamut differences for highlights or shadows. </p>
<h2 align="left"><a name="scanner" id="scanner"></a>Scanner profile: Epson Perfection 4870 Photo </h2>
<p align="left">Epson flatbed scanners  that include transparency units for scanning film come with two profiles: one for reflective operation, the other for transmissive operation, i.e., film scanning. For the 4870 the profiles are named Per487_r.icm and Per487_t.icm, respectively. Both are large: 193 kB. The gamut of the scanner in reflective mode is important because it affects the quality of <a href="../../../docs/docs/printest.html">Print Test</a> results. </p>
<p align="center"><img src="images/Epson4870_Adobe_nomap_Lab.jpg" alt="Epson 4870 scanner and Adobe RGB color spaces" width="602" height="493" /></p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td><p>A quick look shows that the 4870 has similar gamuts in both reflective and transmissive modes and that the gamut is very large: it easily reaches the LittleCMS limits of&nbsp;&plusmn;128 for a* and b*. But Adobe RGB (1998) has a larger gamut for saturated highlight colors. This does not show up on any of the 2D plots. </p></td>
    <td rowspan="2"><div align="center"><img src="images/Epson4870_Adobe_colmtrc_Lab.jpg" alt="Epson 4870 to Adobe RGB, colorimetric intent" width="408" height="393" hspace="8" vspace="4" /></div></td>
  </tr>
  <tr>
    <td><p>When colorimetric rendering intent is applied, the output gamut fits within the input gamut. Light, saturated are apparently darkened slightly. </p></td>
  </tr>
  <tr>
    <td><p>The <a href="http://www.normankoren.com/color_management.html#Sci_nutshell" target="_blank">2D xy chromaticity plot</a> is shown on the right. This plot is less perceptually uniform than the a*b* diagram, but it has two advantages.</p>
      <ul>
        <li>It is familiar and widely used.</li>
        <li>It shows the boundaries of real, physical colors and human vision.  </li>
      </ul>      
    <p>The Epson gamut (dotted line) extends well beyond the region of visible light, an impossible situation that can be explained by noting that the gamut is calculated using a set of pixel values, including the red and blue primaries,  that would never be allowed in practice because they don't correspond to physical reality. This might be expected in a camera or scanner where highly saturated colors in a test chart produces relatively unsaturated RGB values. </p>
    <p>The Epson 4870's gamut cannot be  as large as its profile indicates. The gamut boundary can only indicate the largest possible gamut a device can have, rather than the actual gamut. The boundary for the EOS-20D seems to be much more realistic. </p>
    <p>It would be interesting to compare the manufacturer's profiles (for both the Canon EOS-20D and the Epson 4870) with custom profiles. </p></td>
    <td><div align="center"><img src="images/Epson4870_Adobe_colmtrc_xy.jpg" alt="Epson 4870 to Adobe, xy plot" width="408" height="450" hspace="8" vspace="4" /></div></td>
  </tr>
</table>
<br />
<table width="80%" border="0" align="center" cellpadding="8" cellspacing="0" bgcolor="#EEF9FF">
  <tr>
    <td class="smallbold"><font color="#000033">Input profiles represent devices such as cameras and scanners. They contain the tables that translate RGB input values to XYZ Profile Connection Space. But, alone among profile classes, there can be a wide range  of RGB values that can never occur in practice. And there is nothing in the profile to indicate what these values are. An input profile therefore is not sufficient to characterize device gamut. <br />
      <br />
    </font><font color="#000033">Measurements of large gamut targets such as the IT8.7 or Colorchecker SG provides considerable information about device color response. These charts are supported by the <a href="http://www.imatest.com/docs/tour_multicharts.html">Imatest Multicharts</a> module. </font></td>
  </tr>
</table>
<br />
<h2><a name="m8" id="m8"></a>Response to Luminous-Landscape's Leica M8 review </h2>
<p>In the <em><strong><font color="#444400" face="Arial, Helvetica, sans-serif">Gamut</font></strong></em> section of Michael Reichmann's <a href="http://luminous-landscape.com/reviews/cameras/leica-m8.shtml" target="_blank">Leica M8&nbsp;- A Hands-on Field Review</a> (about half-way down the page), Michael discusses the gamuts of various digital cameras, illustrating them with xy chromaticity diagrams derived from ICC profiles supplied by Phase One. Towards the end of this section he states,</p>
<blockquote>
  <p class="small">The bottom line on this discussion is that the Leica M8 appears    to have the widest colour gamut, by a wide margin, of any camera of which I    am aware.  Does this translate into any image quality advantage? According    to <em><strong>Dr. Know</strong></em>, a friend who writes raw software, and    who is extremely knowledgeable in this area, the answer is likely no. Gamut    plots of camera profiles are not particularly meaningful and don't correlate    with actual sensor or camera performance. But, nevertheless I have to think    that we are seeing something at work here, if not just an indication of what    electronic filtering is taking place inside the camera. If anyone really does    understand the implications of what we're seeing here I    would enjoy hearing from you.    Please though &ndash; not what you <em>guess</em>, not what you <em>imagine</em>, but what you actually <em><strong>know</strong></em> to    be at work here.</p>
</blockquote>
<p> Here is my response. Michael felt it would go over the heads of most readers. (Note: &quot;<em><strong>Dr. Know</strong></em>&quot; is evidently Thomas Knoll, the original author of Photoshop.) </p>
<hr align="center" width="94%" />
<p> I wrote <em><strong><a href="http://www.gamutvision.com/">Gamutvision</a></strong></em> and <em><strong><a href="http://www.imatest.com/">Imatest</a></strong></em> so I (and others) could answer questions such as this. <br />
  <br />
  The quick answer is that &quot;Dr. Know&quot; is correct. You can't derive a  camera's gamut from its ICC profile. I had hoped to do so&mdash; a  reasonable expectation since you can obtain accurate monitor, color  space, and printer gamuts from profiles. <br />
  <br />
The reason is that gamut viewer programs start  with a set of RGB pixel values that represent the RGB gamut limits&mdash; the most saturated possible RGB colors&mdash; then use the profile to transform these colors into a  device-independent color space (CIE XYZ or CIELAB) that can represented  by a familiar diagram like  CIE xy. In a similar manner, camera output, which consists of de-mosaiced RGB values, is transformed by the profile into  CIE XYZ for further conversion to the output color space (sRGB, Adobe RGB, ProPhoto, etc.). <br />
<br />
Gamut viewers can't estimate camera gamut because most of the RGB values near gamut limits can never be output by the camera&mdash;  and the  profile contains no indication of which RGB values the camera <em><strong>can</strong></em> produce. All the  profile does is map RGB values to corresponding device-independent CIE  XYZ values, regardless of whether or not the camera can produce them&mdash; even if they don't correspond to physical reality. Colors close to those in the test chart used to create the profile should be mapped correctly, but anything can happen to RGB values that don't correspond to valid, physical colors: strange spikes and irregularities often appear in gamut representations. <em><strong>These irregularities are meaningless</strong></em>: they are computation artifacts that do not indicate how the profile handles real colors. <br />
<br />
I alluded to this in a comment I made in Gerard Kingma's article on <em><strong><a href="http://www.luminous-landscape.com/reviews/accessories/fancy_graphics.shtml">Gamutvision and PrintFIX PRO</a></strong></em>. &quot;<em>Gamutvision uses a test pattern with the most  saturated possible RGB values, but the scanner may not ever output these values  in practice. So the actual scanner gamut may be smaller than the gamut displayed  by Gamutvision. No easy way around this...</em>&quot; <br />
<br />
The boundaries of the CIE xy &quot;horseshoe&quot; diagram represent  monochromatic light&mdash; anything outside the diagram is non-physical. The  closed horseshoe represents the limits of human vision. Colors displayed by gamut viewers that are outside the horseshoe boundary correspond to RGB values that can <em><strong>never</strong></em> be produced by a camera in response to a real, physical stimulus. Their existence is clear evidence that gamut viewers can't produce valid results for camera or scanner profiles.<br />
<br />
Camera gamut is primarily determined by the the sensor's spectral  response or quantum efficiency, which can be found in the  manufacturer's data sheets. Kodak publishes these curves for a great many sensors, including the <a href="http://www.kodak.com/ezpres/business/ccd/global/plugins/acrobat/en/datasheet/fullframe/KAF-10500LongSpec.pdf">KAF-10500</a> sensor used in the Leica M8, the <a href="http://www.kodak.com/ezpres/business/ccd/global/plugins/acrobat/en/datasheet/fullframe/KAF-39000LongSpec.pdf">KAF-39000</a> used in the Phase One P45 back. You can find them by navigating from <a href="http://www.kodak.com/go/imagers">www.kodak.com/go/imagers</a>. It's not easy to calculate (or even define) total camera gamut, but we can make an important observation: digital cameras can detect all visible colors (roughly 380-720 namometers), and since each monochromatic (pure spectral) color appears to have a unique (R:G:B) ratio, all visible colors can be distinguished, and are potentially inside the camera's gamut. But the actual camera gamut depends on details of the implementation that can't be extracted from the ICC profile. <br />
<br />
The shapes of the the spectral response (quantum efficiency) curves of  the KAF-10500 and KAF-39000 are quite similar (an indication that their  gamut is similar), but there is one interesting difference: red  efficiency is much higher relative to blue and green in the KAF-39000.  This means that R values output by the KAF-39000 will be larger,  resulting in a weaker CIE XYZ value for pure red (255,0,0): a  value neither sensor is ever likely to output. This result is clearly  visible in your images, where the P45 appears to have a much weaker red  response than the M8. But this is a gamut viewer artifact; it bears no relationship to the camera's true gamut.<br />
<br />
Camera gamut is also affected by two other factors: lens flare and  exposure. Lens flare tends to smudge the most intense colors, hence it  reduces camera gamut in real-world situations. Leica lenses are  renowned for having low flare. Exposure affects the measured gamut in  rather complex ways&mdash; especially since many cameras have exposure  strategies designed to match RAW conversion algorithms. For example,  many cameras may underexpose relative to the ISO standard, then perform  RAW conversion with a &quot;shoulder&quot; to reduce the likelihood of saturating  highlights&mdash; a generally excellent strategy, but one that doesn't make  gamut measurement easy. Overexposure always reduces the measured gamut.<br />
<br />
The best way to measure a camera's color response is to photograph and  analyze color a chart that includes relatively saturated colors. The  24-patch GretagMacbeth ColorChecker is insufficient for this purpose;  the ColorChecker SG and the (relatively inexpensive) IT8.7 charts are  much better. <em><strong><a href="http://www.imatest.com/docs/tour_multicharts.html">Imatest Multicharts</a></strong></em> supports both and provides a great deal of information about camera color response.</p>
</body>
</html>
